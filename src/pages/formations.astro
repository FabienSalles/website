---
import Layout from '../layouts/Layout.astro';
import { getAllRecommendations, getStats } from '../data/formations';

// R√©cup√®re une recommandation al√©atoire pour le t√©moignage
const allRecommendations = getAllRecommendations();
const randomReco = allRecommendations[Math.floor(Math.random() * allRecommendations.length)];

// Labels pour les noms de formations
const formationLabels: Record<string, string> = {
  phpunit: 'PHPUnit',
  git: 'Git',
  ddd: 'DDD',
  symfony: 'Symfony',
  sql: 'SQL'
};

// Stats dynamiques depuis les donn√©es
const dataStats = getStats();

const formations = [
  {
    slug: 'phpunit',
    title: 'PHPUnit : √©crire des tests qui durent',
    hook: 'Arr√™te de subir tes tests.<br />Fais-en des alli√©s.',
    problem: 'Tes tests cassent sans raison ? Ils prennent trop de temps √† √©crire et √† maintenir ?',
    promise: 'En 2 jours, apprends √† √©crire des tests qui te font gagner du temps au lieu d\'en perdre.',
    highlights: [
      'Ce qu\'est vraiment un test unitaire',
      'Ma√Ætriser Mocks, Stubs, Fakes',
      'Savoir quand et quoi tester',
      '√âcrire des tests qui durent'
    ],
    duration: '2 jours',
    featured: false
  },
  {
    slug: 'git',
    title: 'Git avanc√©',
    hook: 'Arr√™te de subir Git.<br />Reprends le contr√¥le de ton historique.',
    problem: 'Tu utilises Git tous les jours mais tu ne le comprends pas vraiment ?',
    promise: 'Passe de "√ßa marche je sais pas pourquoi" √† "je sais exactement ce que je fais".',
    highlights: [
      'Branches, merge et rebase sans stress',
      'R√©soudre les conflits sereinement',
      'Choisir le bon workflow d\'√©quipe',
      'Techniques avanc√©es : bisect, reflog, squash, fixup',
      'Worktree et autres outils avanc√©s'
    ],
    duration: '2 jours',
    featured: false
  },
  {
    slug: 'ddd',
    title: 'Domain-Driven Design',
    hook: 'Arr√™te de subir ton organisation.<br />Aligne-la avec tes besoins.',
    problem: 'Le m√©tier et la tech ne se comprennent pas ? Tu subis un couplage qui cr√©e des r√©gressions ?',
    promise: 'Aligne ton √©quipe technique et produit pour livrer ce qui compte vraiment.',
    highlights: [
      'Aligne √©quipe tech et produit',
      'Comprends les probl√®mes pour trouver les bonnes solutions',
      'Isole ton code et ton √©quipe correctement',
      'Mets en avant la complexit√© m√©tier et mets de c√¥t√© celle qui te g√™ne'
    ],
    duration: '3 √† 5 jours',
    featured: false
  }
];

const stats = {
  developers: `${dataStats.participants}+`,
  sessions: `${dataStats.sessions}+`,
  since: '2016'
};
---

<Layout
  title="Formations PHPUnit, Git, DDD - Fabien Salles"
  description="Des formations pratiques pour arr√™ter de subir tes outils. PHPUnit, Git, DDD : en 2 √† 5 jours, ma√Ætrise vraiment ce que tu utilises tous les jours."
>
  <div class="container mx-auto px-4 py-12">

    <!-- HERO SECTION -->
    <section class="text-center py-12 mb-12">
      <h1 class="text-4xl md:text-5xl font-bold mb-6 leading-tight">
        Arr√™te de subir ton environnement.<br>
        <span class="text-orange-700">Ma√Ætrise-le vraiment.</span>
      </h1>
      <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-4 leading-relaxed">
        Des formations pratiques, sans bullshit, pour ceux qui veulent comprendre
        ce qu'ils font.
      </p>
      <!-- Stats inline -->
      <div class="flex flex-wrap justify-center gap-8 text-sm text-gray-600 mb-6">
        <div class="flex items-center gap-2">
          <span class="text-2xl font-bold text-gray-900">{stats.developers}</span>
          <span>d√©veloppeurs form√©s</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-2xl font-bold text-gray-900">{stats.sessions}</span>
          <span>sessions depuis {stats.since}</span>
        </div>
      </div>

      <!-- Statut -->
      <div class="flex flex-wrap justify-center gap-3 mb-8">
        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">‚úì Freelance</span>
        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">‚úì Disponible</span>
        <span class="px-3 py-1 text-gray-700 rounded-full text-sm">üìç Paris ‚Äî Full remote ou hybride</span>
      </div>
    </section>

    <!-- FORMATIONS GRID -->
    <section id="formations" class="mb-16 scroll-mt-8 bg-gradient-to-br from-orange-900 to-orange-800 -mx-4 px-4 py-16 md:rounded-lg md:mx-0 md:px-12">
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {formations.map((formation) => (
          <div class="p-8 bg-orange-50 rounded-xl shadow-lg hover:shadow-xl transition-shadow flex flex-col">
            {formation.featured && (
              <div class="text-xs font-semibold text-orange-700 uppercase tracking-wide mb-2">
                Formation phare
              </div>
            )}

            <!-- Header -->
            <div class="mb-6 pb-4 border-b border-orange-200">
              <h2 class="text-2xl font-bold text-gray-900">
                {formation.title}
              </h2>
            </div>

            <!-- Hook -->
            <p class="text-gray-800 mb-6 font-medium" set:html={formation.hook} />

            <!-- Problem -->
            <p class="text-gray-700 mb-5 leading-relaxed">
              {formation.problem}
            </p>

            <!-- Promise (quote style) -->
            <div class="bg-white rounded-lg p-4 mb-5 border-l-4 border-orange-400">
              <p class="text-gray-600 text-sm italic">
                {formation.promise}
              </p>
            </div>

            <!-- Highlights -->
            <ul class="space-y-2 text-gray-700 text-sm mb-6 flex-grow">
              {formation.highlights.map((item) => (
                <li class="flex items-start gap-2">
                  <span class="text-orange-600 mt-0.5">‚úì</span>
                  <span>{item}</span>
                </li>
              ))}
            </ul>

            <!-- Footer -->
            <div class="mt-auto pt-4 border-t border-orange-200 flex items-center justify-between">
              <span class="text-sm font-medium text-gray-700">
                {formation.duration}
              </span>
              <a
                href={`/formations/${formation.slug}`}
                class="inline-block bg-orange-700 text-white px-5 py-2.5 rounded-lg font-semibold hover:bg-orange-800 transition-colors"
              >
                D√©couvrir ‚Üí
              </a>
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- T√âMOIGNAGE COURT -->
    <section class="mb-16 bg-gray-50 -mx-4 px-4 py-10 md:rounded-lg md:mx-0 md:px-12">
      <div class="max-w-3xl mx-auto">
        <blockquote class="text-center">
          <p class="text-xl text-gray-700 mb-6 leading-relaxed">
            "{randomReco.recommendation}"
          </p>
          <footer class="text-gray-600">
            <span class="font-semibold">{randomReco.name}</span> ‚Äî Participant formation {formationLabels[randomReco.formationName] || randomReco.formationName}
          </footer>
        </blockquote>
        <div class="text-center mt-6">
          <a href="/recommendations#formations" class="text-orange-700 font-semibold hover:text-orange-800">
            Voir toutes les recommandations ‚Üí
          </a>
        </div>
      </div>
    </section>

    <!-- FORMATION SUR MESURE -->
    <section class="mb-16">
      <div class="bg-gradient-to-br from-orange-900 to-orange-800 text-white p-8 md:p-12 rounded-lg">
        <div class="max-w-3xl mx-auto text-center">
          <h2 class="text-2xl md:text-3xl font-bold mb-4">
            Formation sur mesure
          </h2>
          <p class="text-orange-100 text-lg mb-8 leading-relaxed">
            Je peux adapter mes formations √† tes besoins sp√©cifiques et au niveau de ton √©quipe.
            N'h√©site pas √† me contacter pour discuter de tes objectifs.
          </p>
          <div class="flex flex-wrap justify-center gap-4">
            <a
              href="/contact?subject=formation-sur-mesure"
              class="inline-block bg-white text-orange-900 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-orange-50 transition-colors duration-300"
            >
              On en discute ?
            </a>
            <a
              href="https://www.linkedin.com/in/fabiensalles/"
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-2 bg-white/10 text-white border-2 border-white/30 px-6 py-4 rounded-lg text-lg font-semibold hover:bg-white/20 transition-colors duration-300"
            >
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
              LinkedIn
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- INFO NDA -->
    <section class="mb-16 bg-green-50 -mx-4 px-4 py-12 md:rounded-lg md:mx-0 md:px-12">
      <div class="max-w-3xl mx-auto text-center">
        <span class="text-5xl block mb-4">üéì</span>
        <h3 class="text-xl font-bold text-green-800 mb-2">Organisme de formation d√©clar√©</h3>
        <p class="text-green-700">
          Num√©ro de d√©claration d'activit√© (NDA) aupr√®s de la DREETS.<br>
          Formations exon√©r√©es de TVA (article 261-4-4¬∞a du CGI).
        </p>
      </div>
    </section>

    <!-- Liens vers autres offres -->
    <section class="mb-16 bg-gray-50 -mx-4 px-4 py-12 md:rounded-lg md:mx-0 md:px-12">
      <div class="max-w-3xl mx-auto text-center">
        <h3 class="text-xl font-bold mb-6">Tu cherches autre chose ?</h3>
        <div class="flex justify-center gap-3 text-sm">
          <a href="/accompagnement" class="inline-flex items-center gap-2 px-3 py-2 bg-white rounded-lg border border-gray-200 text-gray-700 hover:border-orange-400 transition-colors">
            <span>üéØ</span>
            <span><strong>Accompagnement</strong></span>
          </a>
          <a href="/audit" class="inline-flex items-center gap-2 px-3 py-2 bg-white rounded-lg border border-gray-200 text-gray-700 hover:border-orange-400 transition-colors">
            <span>üîç</span>
            <span><strong>Audit</strong></span>
          </a>
          <a href="/automatisation" class="inline-flex items-center gap-2 px-3 py-2 bg-white rounded-lg border border-gray-200 text-gray-700 hover:border-orange-400 transition-colors">
            <span>ü§ñ</span>
            <span><strong>IA & Automatisation</strong></span>
          </a>
          <a href="/apport-affaires" class="inline-flex items-center gap-2 px-3 py-2 bg-white rounded-lg border border-gray-200 text-gray-700 hover:border-orange-400 transition-colors">
            <span>ü§ù</span>
            <span><strong>Apport d'affaires</strong></span>
          </a>
        </div>
      </div>
    </section>

  </div>
</Layout>
